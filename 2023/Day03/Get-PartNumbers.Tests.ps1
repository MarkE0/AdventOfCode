BeforeAll {
    # Import the Get-PartNumbers.ps1 script
    . $PSScriptRoot\Get-PartNumbers.ps1
}

Describe "Get-PartNumbers" {
    Context "Day 3 Part 1" {
        It "Should return the correct part numbers" {
            # Arrange
            $Content = @(
                "467..114..",
                "...*......",
                "..35..633.",
                "......#...",
                "617*......",
                ".....+.58.",
                "..592.....",
                "......755.",
                "...$.*....",
                ".664.598.."
            )

            # Act
            $PartNumbersSum = Get-PartNumbersSumP1 -Content $Content

            # Assert
            $PartNumbersSum | Should -Be 4361
        }

        It "Should handle single digit numbers" {
            # Arrange
            $Content = @(
                "1..788.............................54.........501...........555.........270.................................521......893...................."
                "+.../..*963........................*..860......................*....53...../.....................52.................&....347........428*522."            
                "............*......41..481+.......462....$..187......678.......420....-....................&115.+...........................+..............."
                "............................................................................................................................................"
            )

            # Act
            $PartNumbersSum = Get-PartNumbersSumP1 -Content $Content

            # Assert
            $PartNumbersSum | Should -Be 7264
        }

        It "Should handle numbers at the end of the line" {
            # Arrange
            $Content = @(
                "1..788.............................54.........501...........555.........270.................................521......893.................*10"
                "+.../..*963........................*..860......................*....53...../.....................52.................&....347........428*522."            
                "............*......41..481+.......462....$..187......678.......420....-....................&115.+...........................+..............."
                "............................................................................................................................................"
            )

            # Act
            $PartNumbersSum = Get-PartNumbersSumP1 -Content $Content

            # Assert
            $PartNumbersSum | Should -Be 7274
        }
    }

    Context "Day 3 Part 2" {
        It "Should return the correct Gear Ratio Sum" {
            # Arrange
            $Content = @(
                "467..114..",
                "...*......",
                "..35..633.",
                "......#...",
                "617*......",
                ".....+.58.",
                "..592.....",
                "......755.",
                "...$.*....",
                ".664.598.."
            )

            # Act
            $PartNumbersSum = Get-GearRatioSumP2 -Content $Content

            # Assert
            $PartNumbersSum | Should -Be 467835
        }
    }
}